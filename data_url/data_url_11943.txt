Part of #1422
