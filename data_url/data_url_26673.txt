Hello. Morning.
I tried to install cp2k 8.1 using toolchain method.
in this method, superlu-6.1.0 could not be passed.
the environements are gnu with devtoolset-9.3.1 or devtoolset-10.2.1 , openmpi4.0.5  and mkl 2020.4 preinstalled on redhat 7.9 with non-root.
cmake with 3.18.5 is binary executable downloaded from the website of https://cmake.org/download/.
make.log
1_toolchain-mkl+gnu.sh.txt
the make.log record many erros about cmake and openmpi.
the first serveral lines of the makelog like below directly suggest the erros due to the omp.
"undefined reference to `ompi_mpi_cxx_op_intercept"
I tried openmpi 3.1.0. but it reports the similar errors.
make.log
Hi You may try an openmpi 3.x version instead of openmpi 4.x one, since openmpi 4.x is no longer permissive concerning some deprecated interfaces. Matthias Von: alas-go notifications@github.com Gesendet: Freitag, 1. Januar 2021 04:12 An: cp2k/cp2k cp2k@noreply.github.com Cc: Subscribed subscribed@noreply.github.com Betreff: [cp2k/cp2k] superlu-6.1.0 could not be passed under gnu and openmpi4.0.5 with devtool-gcc-9.3.1 and mkl 2020.4 on redhat 7.9 (#1274) Hello. Morning. I tried to install cp2k 8.1 using toolchain method. in this method, superlu-6.1.0 could not be passed. the environements are gnu with devtool-gcc-9.3.1 , openmpi4.0.5 and mkl 2020.4 preinstalled on redhat 7.9. cmake with 3.18.5 is binary executable download from the website of https://cmake.org/download/ make.loghttps://github.com/cp2k/cp2k/files/5758598/make.log 1_toolchain-mkl+gnu.sh.txthttps://github.com/cp2k/cp2k/files/5758602/1_toolchain-mkl%2Bgnu.sh.txt the make.log record many erros about cmake and openmpi. — You are receiving this because you are subscribed to this thread. Reply to this email directly, view it on GitHub<#1274>, or unsubscribehttps://github.com/notifications/unsubscribe-auth/ACN625MZ5FSGJY4SLIF4EMTSXU4RPANCNFSM4VP55PHA. [ { "@context": "http://schema.org", "@type": "EmailMessage", "potentialAction": { "@type": "ViewAction", "target": "#1274", "url": "#1274", "name": "View Issue" }, "description": "View this Issue on GitHub", "publisher": { "@type": "Organization", "name": "GitHub", "url": "https://github.com" } } ]
here, i upload the file again after restart the terminal and run the toolchain.sh onece more
in this part , it runs cmake successfully, but it fails to  make .
cmake.log
make.log
in the condition of gcc-9.3.1, openmpi-4.1.0  with openblas, superlu-6.1.0 also report the same error, which indicate to the omp.
make.log
today, after renewed the cp2k-master code. I reinstaledl with openmpi-3.1.0 & openblas. it reports some basename missing under the condition of devtoolset-gcc-9.3.1 and 10.2.1
==================== Installing SuperLU_DIST ====================
basename: missing operand
Try 'basename --help' for more information.
today, after renewed the cp2k-master code, I also reinstaledl with openmpi-4.1.0 & openblas, it still reports some errors about omp and interceptor.
make.log
There is still listed openmpi-4.0.5 in your make.log. Von: alas-go notifications@github.com Gesendet: Freitag, 1. Januar 2021 15:50 An: cp2k/cp2k cp2k@noreply.github.com Cc: Krack Matthias (PSI) matthias.krack@psi.ch; Comment comment@noreply.github.com Betreff: Re: [cp2k/cp2k] superlu-6.1.0 could not be passed under gnu with devtool-gcc-9.3.1, openmpi4.0.5 and mkl 2020.4 on redhat 7.9 (#1274) I tried openmpi 3.1.0. but it reports the similar errors. make.loghttps://github.com/cp2k/cp2k/files/5759068/make.log Hi You may try an openmpi 3.x version instead of openmpi 4.x one, since openmpi 4.x is no longer permissive concerning some deprecated interfaces. Matthias Von: alas-go notifications@github.commailto:notifications@github.com Gesendet: Freitag, 1. Januar 2021 04:12 An: cp2k/cp2k cp2k@noreply.github.commailto:cp2k@noreply.github.com Cc: Subscribed subscribed@noreply.github.commailto:subscribed@noreply.github.com Betreff: [cp2k/cp2k] superlu-6.1.0 could not be passed under gnu and openmpi4.0.5 with devtool-gcc-9.3.1 and mkl 2020.4 on redhat 7.9 (#1274<#1274>) Hello. Morning. I tried to install cp2k 8.1 using toolchain method. in this method, superlu-6.1.0 could not be passed. the environements are gnu with devtool-gcc-9.3.1 , openmpi4.0.5 and mkl 2020.4 preinstalled on redhat 7.9. cmake with 3.18.5 is binary executable download from the website of https://cmake.org/download/ make.loghttps://github.com/cp2k/cp2k/files/5758598/make.log 1_toolchain-mkl+gnu.sh.txthttps://github.com/cp2k/cp2k/files/5758602/1_toolchain-mkl%2Bgnu.sh.txt the make.log record many erros about cmake and openmpi. — You are receiving this because you are subscribed to this thread. Reply to this email directly, view it on GitHub<#1274<#1274>>, or unsubscribehttps://github.com/notifications/unsubscribe-auth/ACN625MZ5FSGJY4SLIF4EMTSXU4RPANCNFSM4VP55PHA. [ { "@contexthttps://github.com/context": "http://schema.org", "@typehttps://github.com/type": "EmailMessage", "potentialAction": { "@typehttps://github.com/type": "ViewAction", "target": "#1274<#1274>", "url": "#1274<#1274>", "name": "View Issue" }, "description": "View this Issue on GitHub", "publisher": { "@typehttps://github.com/type": "Organization", "name": "GitHub", "url": "https://github.com" } } ] — You are receiving this because you commented. Reply to this email directly, view it on GitHub<#1274 (comment)>, or unsubscribehttps://github.com/notifications/unsubscribe-auth/ACN625NCNIRXWSEFMHSWUD3SXXOKPANCNFSM4VP55PHA. [ { "@context": "http://schema.org", "@type": "EmailMessage", "potentialAction": { "@type": "ViewAction", "target": "#1274 (comment)", "url": "#1274 (comment)", "name": "View Issue" }, "description": "View this Issue on GitHub", "publisher": { "@type": "Organization", "name": "GitHub", "url": "https://github.com" } } ]
This seems to be very relate to your other toolchain issues. Let's continue the discussion at #1275.
Here, the omp/ompi errors has been reproduced again when install superlu_dist-6.1.0 on  Fedora 33 with openmpi-4.0.5, openblas and gcc-10.2.1.  The openmpi-4.0.5  was compiled and installed before toolchain installation with " --enable-mpi-fortran --enable-shared --enable-static --enable-mpi --enable-openmp --enable-mpi-cxx --enable-mpi1-compatibility "
make.log
