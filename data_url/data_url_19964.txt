The cleanup section in tests/test_sig.c has a check if sig != NULL, in which case it will free the secret_key buffer. But a bunch of other buffers are also only mallocd after sig is initialized.  This would not be a problem, because OQS_MEM_insecure_free handles NULL correctly, however, sizeof(magic_t) is subtracted from each of these pointers.
This should probably be handled differently; just moving the checks into the sig != NULL if is probably not sufficient as there is another case where they may end up there with some buffers partially initialized; if one of the mallocs fails.
test_kem.c likely has similar problems
