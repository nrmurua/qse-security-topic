Last if is not covered by existing tests.

Might also be better to use pytest.parametrize to condense some of the existing tests.
