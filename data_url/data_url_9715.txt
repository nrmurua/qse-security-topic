I wrote
for something unrelated, but we could wrap this functionality up in a generator or something.
