When I try to simulate the density matrix through a circuit using simulate_moment_steps, I have some density matrices that have a trace different than 1 for some steps. For instance, when I execute the simple code below, the last line returns 1/2. If I did no mistake, this means that the simulator returns a density matrix that has trace less than 1. From what I can see, this could be caused by the insert strategy (maybe it interferes with the moment by moment simulator). Did you already hear about such an issue?
It appears that the simulator is re-using and modifying the matrix returned by .density_matrix() during later steps.  This was probably intended behavior to improve speed but can cause strange usability issues like you found.  If others have done this too I would consider it a bug.
Try this instead.  You get the correct result if you use the matrix before the next simulation step.
If you do need to store all the density matrices (I would not recommend this for circuits much larger than your example), just make copies of the matrix:
Thanks a lot for your quick answer!
The density matrix is now a copy by default.  This should fix your original code by default.  If you need the more optimized version you can request it by setting the copy boolean when accessing the density matrix.
