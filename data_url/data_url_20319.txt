Depends on #377
Resolved by #403
