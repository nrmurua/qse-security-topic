I'm testing the current version of the stack on all my old test devices, and Raspberry Pi 3 support seems to be very broken, at the moment. Given how time has progressed since Raspberry Pi support was added, I would at least like to support the 4 moving forward, rather than the 3. I'll attempt to debug support for the 3 meantime, but I'll have a new 4 around Christmas.
This might or might not indicate a deeper problem in QUnit that doesn't commonly manifest, hence problems on the 3 have always been worth diagnosing, in the past.
For the ARM7, at least, the problem in its entirety seems to have been a single uninitialized Boolean in a struct constructor. We're not going to do a formal review for this, unless Benn happens to be looking this way right now. See #266.
I'd love to continue to support the RP3 era VideoCore GPU, as well, simply to make the Qrack library as universally backwards compatible as possible. The OpenCL support for that device is provided solely by doe300/VC4CL. That's an awesome project, and I love it and give them many thanks for it, but the device itself is extremely intrinsically limited, and it seems like we might have lost support for pre-compilation of kernels, or compilation of the Qrack program at all, since our earliest successful experiments with that runtime. I'll see what I can do. The VC4CL project has also moved forward, and I don't take it for granted that Qrack is 100% as stringent and backwards compatible as the fundamentally correct ways to support OpenCL on that device, though I would like for it to be.
I'm getting mpark::bad_variant_access every time I try to build for the VideoCore IV. This is a new problem; we have previously compiled and run OpenCL on the device in the past.
The mpark::bad_variant_access was confirmed to be a bug in VC4C, by its creator. With a fix from doe300, we compile, but there are still some failing unit tests. I'm deferring debugging unit tests for VC4CL until pending changes are merged into that project and its dependencies.
VC4CL and its dependencies have since received an update from doe300, and now we at least compile and run with the standard libraries. We fail about 3 unit tests, though. Here's what I've noticed:
Again, we run on ARM7 just fine; it's specifically on the VideoCore IV with VC4CL that we fail a limited number of tests. In the past, when VC4CL builds failed tests, Xeon build tests tended to fail, as well; there are no Xeon failures, this time. I'd like to get to the bottom of this, but it's difficult to make headway with such a limited platform, and these problems don't occur on any other platform I have at my immediate disposal.
Unit tests are now a full pass on my Raspberry Pi 3 with VideoCore IV OpenCL provided by VC4CL. The problems mostly seem to have been in the unit tests themselves rather than in the OpenCL, but fixes crept in over the past few months as I merged PRs. (I love when that happens!)
