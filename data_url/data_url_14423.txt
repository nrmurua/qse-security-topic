The idea is from https://quantumcomputing.stackexchange.com/a/26950/20884

related pr: #7904
