See #621 for the two-term version of this.
