Input validation and error reporting has been overhauled in the density matrices branch
