First draft in #472
Implementation can be based on #164
Implemented in #472
@eendebakpt please reopen if #472 is not sufficient.
