similar to other simulators.
Instead of running the density simulation once per repetition, run it once and then sample from the final density matrix multiple times. Works almost exactly the same as in the sparse wavefunction simulator; there is existing code to sample from the density matrix.
I'm happy to look into this, it seems doable in 2 weeks with iterations.
