Right before the 0.18.0 release we reverted #6534 as it was causing a nondeterministic CI failure for one test (see #6686 for more details). After the 0.18.0 release goes out and #6685 merges we should push a revert of the revert PR and reapply #6534 and get to the bottom of the failures since the performance improvement was good (and it also enables follow-on improvements leveraging retworkx in #6680).
