Currently non-unit gates can overhang the circuit, can overlap other gates, and have hit targets smaller than their drawn span. Fix all that.
Oops; dupe of #4
