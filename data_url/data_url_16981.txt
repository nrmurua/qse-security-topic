Similar to #3256

