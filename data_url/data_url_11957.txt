Part of #1425
