The current API for AES and FIPS202 still completely relies on the full state being on the stack. This is not a very friendly assumption when you want to allow swapping out the implementation for these primitives, and may be something we want to fix, but it's there for now.
Solving this would require adding _copy and _free functions to all primitives exposed by the PQClean common API. We should then also somehow make sure that these _copy and _free functions are used... This might already require that we put the common/ implementations on the heap to allow Valgrind to find the leaks.
See also #207, #247, open-quantum-safe/liboqs#600 for examples where this came up already.
