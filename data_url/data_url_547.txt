may need to use kernel_evaluator functor like passed from qcor
https://github.com/autodiff/autodiff
