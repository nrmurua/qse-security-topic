Part of #1401
