Part of #1433
Can be considered done when these PRs are merged
