The method program_unitary ought to interpret defgates. Secondly, it would be useful to document that the function returns the unitary in a non-conventional order and add a flag to return in the standard one.
