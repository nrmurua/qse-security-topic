Supersedes #101.
The signature of this function should be something like
potentially with additional arguments (sigma, etc.). By convention, the input circuit should not be modified.
Assigning to @yhindy as discussed in last week's engineering meeting.
I apologize for not getting to this sooner, I'll handle it by the weekend
