I didn't remove virtual calls but instead changed them so that LLVM optimizes them well, which was easier. So, closing.
