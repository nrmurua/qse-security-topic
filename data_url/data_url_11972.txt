Part of #1433
