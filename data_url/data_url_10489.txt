Implement the algorithm described in https://arxiv.org/abs/1201.1842
