This can be done stochastically.
https://arxiv.org/abs/1506.05254
