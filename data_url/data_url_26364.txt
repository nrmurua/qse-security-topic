Particularly in high-throughput studies, where one does not know a priori whether a given structure is metallic or insulating, it can be useful to use diagonalization with smearing as a fallback if orbital transformation does not converge.
Fermi-Dirac smearing is known to introduce rather strong deviations in e.g. the atomic forces compared to other smearing schemes (see e.g. Figure 7 of this paper).
To your knowledge, has there been any work in the direction of extending the smearing schemes available in cp2k (forks, ...)?
If not, would it be possible to get some pointers on where/how to best get started; any details one should pay attention to?
I guess the place to start would be here.
Apropos: @flavianojs from our group just added to Quantum Espresso an implementation for reliably computing Fermi energies for Methfessel-Paxton and Marzari-Vanderbilt smearing (which produce non-monotonous occupations) and might be able to help a bit with this as well.
Recently, I looked into that issue for the same reason, since Fermi-Dirac smearing is not optimal (e.g. long distribution tails) and it would be nice indeed to have MP smearing as an alternative (like in VASP with ISMEAR = 0, 1, or 2). Your starting point is fine, but with k points you should also consider this spot. The module fermi_utils has either to be generalized to a smearing module or a new methfessel_paxton module has to be added.
