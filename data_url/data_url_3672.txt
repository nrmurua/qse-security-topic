I believe this is because part of the docs uses .. code:: ipython3 and other parts use .. code:: ipython2. Using the .. code:: python everywhere fixes this.
