This wasn't documented properly, but the intention was that the tau_vals that get passed to the chi_constructor are for the current iteration only. Instead, optimize_pulses currently is passing it the list of lists of tau_vals, for all iterations. In aa91f33 @FernandoGago and @MatthiKrauss adapted chis_ss and chis_sm to this wrong behavior. But the bug is really in optimize_pulses, and in the missing documentation what the interface for the chi_constructors is.
I will fix both of these.
(Good thing we added tests for the functionals J_T_sm and J_T_ss, where the Ï‡ actually depend on the overlaps! This bug would not have shown itself otherwise!)
