I can do the optimisation of a gate in the rotating frame by setting model.set_FR(true). The full propagator of that gate (=product of the partials) is then changed by the frame rotation before optimisation. However, for plotting the examples use the partial propagators, which are in the lab frame. That means that what's optimised (the full propagator) does not match the plots (the state propagated by the partials).
I'm not sure if this does occur for two-level systems or is just too small to see. It definetely shows up for more than two levels because the upper levels have different rotation frequencies.
Optimised propagator and plots of level populations should match. Probably, the partials need to be adjusted by the frame rotation.
If applicable, add screenshots to help explain your problem.
