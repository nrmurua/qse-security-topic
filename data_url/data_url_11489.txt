This was posted on external Slack workspace
Today I tried to train my qGAN network and in parallel to obtain the parameters of the quantum generator and the discriminator during all the training epochs. The "snapshot_dir" argument is loaded but I get an error message telling me:
'QuantumCircuit' object has no attribute 'params'
This logic in QGAN attempts to access params field and fails when the generator is a TwoLocal circuit (or presumably some other QuantumCircuit chosen by the user). It used to work when the generator supported only the Uni/MultiVariationalDistributions as these have a params field. The logic below needs to accommodate for a QuantumCircuit when its directly provided (especially so as the default is to TwoLocal)
https://github.com/Qiskit/qiskit-aqua/blob/749d2f9b3ea3cea69111c5d85a9eb77c9b6db93b/qiskit/aqua/algorithms/distribution_learners/qgan.py#L266-L268
Although the QuantumGenerator has been deprecated in terms of Uni/MultiVarDists in its constructor the set_generator in QGAN does not raise any warning if they are used and arguably should. (Although with the whole of Aqua being deprecated this is arguably a mute point, but it will maintain consistency with the generator contructor in signalling their deprecation)
https://github.com/Qiskit/qiskit-aqua/blob/749d2f9b3ea3cea69111c5d85a9eb77c9b6db93b/qiskit/aqua/algorithms/distribution_learners/qgan.py#L195-L198
It would be good to have a unit test that covers the snapshot_dir usage too as I did not see one.
Since the Uni/MultiVarDists are already deprecated themselves (in fact constructing anything deriving from CircuitFactory raises a deprecation error), do we still need to add one inside the algorithms? We could instead also just delete the CircuitFactory and derived classes since they've been deprecated for well over 3 months now.
On the other hand, since Aqua will be deprecated soon it might not be worth the effort. But then again it would be nice if the "final" Aqua version didn't have trailing deprecation warnings.
The main problem here is not the lack of a deprecation warning, that I happened to notice, more that the method to write a row to the output dir fails since there is no params field on the object it is accessing. I believe that logic did work as it was used in the past, but maybe the addition of the QuantumCircuit, to replace the Distributions, changed something which broke it, as it no longer works with the distributions either it seems.
In terms of the deprecation I did note that arguably its a none issue as the whole of Aqua will be deprecated. As part of putting the overall deprecation messages into Aqua maybe removing the old logic should be done. As you say I do not know whether it worth the effort or not - depends on how complex any removal might be.
The PR to fix the snapshot_dir params issue is on the way. Then, we will keep the VariationalDistributions for now.
Closing as this was fixed by #1545
