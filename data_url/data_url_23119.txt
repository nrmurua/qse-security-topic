typical units are:
Vpk (linear scale), Vrms^2/Hz, related ones
units of power such as W, J, dBm are not recommended since we would have to assume an impedance for this (not sure the user will use 50 Ohm in parallel with input, even more confusing when digital signals are measured)
Are you able to do this in the next 2 weeks Samuel?
Ok
I have designed the low-pass filter that is required for implementing the Spectrum Analyzer in IQ mode (see the new section at the end of the wiki).
I am pretty sure that code will not be synthesizable with the require two 8th-order IIR filters, so I suggest to leave the implementation to a later version (0.9.4) with cleaned FPGA code. However, I mention another possibility for good IQ spectra right now (see copy-paste below). The other option is in my opinion to disable IQ mode usage of the specan for the coming release version.
We could however opt for another temporary option, applicable only to stationary signals: Measure the spectrum twice or thrice with slightly shifted IQ demodulation frequency (at +- 10% of span and the actual center, as required above), and only plot the pointwise-minimum (with respect to the final frequency axis) of the obtained traces. This is simple and should be very effective (also to reduce the central peak at the demodulation freuqency), so i suggest we give it a try. Furthermore, it prepares the user that IQ spectra will only have 80% of the points in baseband mode, which will remain so after the implementation of the lowpass filter. The plot above shows that we do not have to worry about aliasing from multiple spans away if the bandwidth if the IQ module is se to the scope sampling rate (or slightly below). I am not aware that this method is used anywhere else, but do not see any serious problem with it.
I see this a little bit as a "Volkswagen anti-pollution test hack", because it makes you believe everything is working fine as long as you perform tests on single monochromatic peaks, but as soon as you go to a distributed noise spectrum, the aliasing is not remove since the 3 spectra are affected essentially in the same way...
of course the minimum scheme would only work for coherent peaks. if you dont like it, let's just disable the IQ option for now
Right now, I just throw a NotImplementedError whenever the user tries to acquire a curve in iq mode. The checkbox is still there, but I believe the error message (not implemented in the current release) is explicit enough... Apart from that, there is a unittest for the Vpk spectrum flatness.
