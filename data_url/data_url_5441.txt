Compute memory footprint from real size of patches, and not from their rank, since different indexes usually have different dimensions.
This was solved in #252.
