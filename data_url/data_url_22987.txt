before lock:
calibrate input a, b, c
custom function
after lock:
gain_optimizer
custom function
