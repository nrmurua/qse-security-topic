Follow the approach taken by OpenSSL or another one: Suggestions welcome below.
