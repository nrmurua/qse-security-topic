Sub-issue to #340
