I think we should add more tests to see how the compiler is behaving with a wide variety of combinations. Some that I could think of (likely not comprehensive):
Originally posted by @boschmitt in #898 (review)
See #875 as well.
