In the recent #3232, by opening the do_rotate in calculate_subspace_eigenvalues will change the original MO. It will seriously affect the stability of molecular dynamics with OT method. Set the PRINT MO in DFT section and running MD with OT method will reveal the problem. The temperature will rise unreasonably. Saving the mo_coeff as mo_coeff_tmp and reset it after writing MO would be a solution as I committed in 50b4588. I may give a PR if this solution is accepted. Thanks!
Thanks for the bug report. Please, could you check if #3239 will fix the bug?
Thanks for the effort! This solution will definitely solve the problem of molecular dynamics, but I'm not so sure how much impact it will have on the MO printed. Is there any reason to use calculate_subspce_eigenvalues ​​at the beginning?
Originally, the occupied MOs as available were printed. The call to calculate_subspace_eigenvalues should only be needed for the unoccupied MOs not yet available. The additional call to calculate_subspace_eigenvalues for the occupied MOs introduced by #3230 was indeed a bug. Thanks again for reporting.
In this case, this bug has been fixed. Thank you for your timely reply!
