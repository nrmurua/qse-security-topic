I'm working on building a Docker image that has quilc, qvm, and pyquil installed in it. To make the build process quicker, I want to leverage the pre-built quilc and qvm Docker images. However, when I build from the quilc image and copy over the /src/quilc directory, the pre-built quilc binary fails to run, even though the libtweedledum.so file was copied along with it. Running make install-tweedledum && ldconfig has no effect on the error, nor does deleting libtweedledum.so from /src/quilc/src/contrib/tweedledum.
Here is a minimal Dockerfile that can be used to reproduce this issue:
With the above stored in a file called "Dockerfile" in your current directory, run docker build -t quilc-error-test . to make the image. Once the image is built, run docker run -it quilc-error-test and then (once inside the Docker container) run ./quilc to reproduce the error.
Post-mortem: the container in which quilc was built had glibc version 2.29, while the container in which quilc was being used had 2.28.
Two possible fixes:
