Currently the circuit optimization pass for qubit truncation does not take the noise model into account. This means for noisy simulations truncation must be done after noise sampling which is very inefficient.
This pass needs to take into account the noise model and check both the circuit for qubits, and the non-local errors in the noise model for instructions in the circuit to find out which qubits are potentially active, and then truncate/remap both the circuit and the noise model.
After this the qubit truncation can be run immediately after loading a circuit and before memory requirements are checked for parallelisation configuration. We will also have to change the CircuitOptimization base class to allow for noise models.
