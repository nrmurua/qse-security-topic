generation of controllable kernel based on multiple qubits.
Implemented in 83a6f53.
