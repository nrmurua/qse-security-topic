As suggested here, the test case for mct modes should also cover the case in which the controls are in a superposition of states.
Also, the advanced mode, being based on Lemma 7.2 of Barenco, should also be working when the ancilla qubit is not in state 0; the ancilla state should be restored to the original one after the circuit application. Maybe an additional check with an ancilla starting from an arbitrary, non zero state could be useful.
