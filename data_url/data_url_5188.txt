The compiler routines all use CL-QUIL's resource abstraction, but the QVM uses a routine called qubits-used which separately implements (the qubit portion of) resource utilization tracking. Consider rewriting qubits-used to use the new resource tracking mechanisms, so that this information only has to get updated in one place.
