I refactored https://github.com/QuantumBFS/YaoAD.jl to enable further development of a smooth hessian interface. Currently since Zygote doesn't use ChainRules, we will be defining reverse mode rules twice.
I guess this should end the historic complaining about using Yao with Zygote etc. will require a patch, now Yao should work with Zygote and any other package that uses ChainRules (e.g Nabla.jl) but I think we still need to fix a few more adjoints in order to make things smoother.
Currently, you will need to add Yao then add https://github.com/QuantumBFS/YaoAD.jl.git, then use other AD engine (E.g Zygote) to enable this feature.
Although this is not the most elegant way of implementing it (the most elegant way should be using YaoIR, but that will take more time to finish), it should solve the problem. I will work on the forward mode gradient rules (a.k.a faithful gradient) next week (maybe the weekend) should be easy to implement in ChainRules, which will make ForwardDiff2 work. then both mixed mode Hessian and forward mode Hessian should just work.
Please feel free to comment on this idea.
