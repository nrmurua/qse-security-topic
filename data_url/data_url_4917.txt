This shouldn't be too hard to make contiguous, making it much faster due by reducing caches
(See density matrix collapseToOutcome for illustration)
