Already implemented on new_gates branch:
and
