This can be trivially adapted from my QuEST-MMA implementation, for both state-vectors and density matrices
Implemented on new_gates, and also for sums of Pauli products
