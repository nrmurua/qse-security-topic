phaseShift implemented (density matrix branch)
all implemented on density matrix branch
